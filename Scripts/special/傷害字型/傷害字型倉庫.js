// 傷害字型倉庫

var status = -1, sel = -1;
var account = false;
var showDamageForDamageSkin = false; // 是否顯示字型增加額外傷害百分比
var money = 1000000; // 兌換需要的金錢
var consumeItem = true; // 是否扣除需求物
var link = "#fEffect/BasicEff.img/NoCri0_";
var exchangeInfo = [
    // [字型編號, 需求物, 需求數量(不需要需求物則填入0)]
    [0, 4000000, 1],
    [1, 4000000, 1],
    [2, 4000000, 1],
    [3, 4000000, 1],
    [4, 4000000, 1],
    [5, 4000000, 1],
    [6, 4000000, 1],
    [7, 4000000, 1],
    [8, 4000000, 1],
    [9, 4000000, 1],
    [10, 4000000, 1],
    [11, 4000000, 1],
    [12, 4000000, 1],
    [13, 4000000, 1],
    [14, 4000000, 1],
    [15, 4000000, 1],
    [16, 4000000, 1],
    [17, 4000000, 1],
    [18, 4000000, 1],
    [19, 4000000, 1],
    [20, 4000000, 1],
    [21, 4000000, 1],
    [22, 4000000, 1],
    [23, 4000000, 1],
    [24, 4000000, 1],
    [25, 4000000, 1],
    [26, 4000000, 1],
    [27, 4000000, 1],
    [28, 4000000, 1],
    [29, 4000000, 1],
    [30, 4000000, 1],
    [31, 4000000, 1],
    [32, 4000000, 1],
    [33, 4000000, 1],
    [34, 4000000, 1],
    [35, 4000000, 1],
    [36, 4000000, 1],
    [37, 4000000, 1],
    [38, 4000000, 1],
    [39, 4000000, 1],
    [40, 4000000, 1],
    [41, 4000000, 1],
    [42, 4000000, 1],
    [43, 4000000, 1],
    [44, 4000000, 1],
    [45, 4000000, 1],
    [46, 4000000, 1],
    [47, 4000000, 1],
    [48, 4000000, 1],
    [49, 4000000, 1],
    [50, 4000000, 1],
    [50, 4000000, 1],
    [51, 4000000, 1],
    [52, 4000000, 1],
    [53, 4000000, 1],
    [54, 4000000, 1],
    [54, 4000000, 1],
    [55, 4000000, 1],
    [56, 4000000, 1],
    [57, 4000000, 1],
    [58, 4000000, 1],
    [59, 4000000, 1],
    [62, 4000000, 1],
    [61, 4000000, 1],
    [62, 4000000, 1],
    [63, 4000000, 1],
    [64, 4000000, 1],
    [65, 4000000, 1],
    [66, 4000000, 1],
    [67, 4000000, 1],
    [68, 4000000, 1],
    [69, 4000000, 1],
    [70, 4000000, 1],
    [71, 4000000, 1],
    [72, 4000000, 1],
    [73, 4000000, 1],
    [74, 4000000, 1],
    [75, 4000000, 1],
    [76, 4000000, 1],
    [77, 4000000, 1],
    [78, 4000000, 1],
    [79, 4000000, 1],
    [80, 4000000, 1],
    [81, 4000000, 1],
    [82, 4000000, 1],
    [83, 4000000, 1],
    [84, 4000000, 1],
    [85, 4000000, 1],
    [86, 4000000, 1],
    [87, 4000000, 1],
    [88, 4000000, 1],
    [89, 4000000, 1],
    [90, 4000000, 1],
    [91, 4000000, 1],
    [92, 4000000, 1],
    [93, 4000000, 1],
    [94, 4000000, 1],
    [95, 4000000, 1],
    [96, 4000000, 1],
    [97, 4000000, 1],
    [98, 4000000, 1],
    [99, 4000000, 1],
    [100, 4000000, 1],
    [101, 4000000, 1],
    [102, 4000000, 1],
    [103, 4000000, 1],
    [104, 4000000, 1],
    [105, 4000000, 1],
    [106, 4000000, 1],
    [107, 4000000, 1],
    [108, 4000000, 1],
    [109, 4000000, 1],
    [110, 4000000, 1],
    [111, 4000000, 1],
    [112, 4000000, 1],
    [113, 4000000, 1],
    [114, 4000000, 1],
    [115, 4000000, 1],
    [116, 4000000, 1],
    [117, 4000000, 1],
    [118, 4000000, 1],
    [119, 4000000, 1],
    [120, 4000000, 1],
    [121, 4000000, 1],
    [122, 4000000, 1],
    [123, 4000000, 1],
    [124, 4000000, 1],
    [125, 4000000, 1],
    [126, 4000000, 1],
    [127, 4000000, 1],
    [128, 4000000, 1],
    [129, 4000000, 1],
    [130, 4000000, 1],
    [131, 4000000, 1],
    [132, 4000000, 1],
    [133, 4000000, 1],
    [134, 4000000, 1],
    [135, 4000000, 1],
    [136, 4000000, 1],
    [137, 4000000, 1],
    [138, 4000000, 1],
    [139, 4000000, 1],
    [140, 4000000, 1],
    [141, 4000000, 1],
    [142, 4000000, 1],
    [143, 4000000, 1],
    [144, 4000000, 1],
    [145, 4000000, 1],
    [146, 4000000, 1],
    [147, 4000000, 1],
    [148, 4000000, 1],
    [149, 4000000, 1],
    [150, 4000000, 1],
    [151, 4000000, 1],
    [152, 4000000, 1],
    [153, 4000000, 1],
    [154, 4000000, 1],
    [155, 4000000, 1],
    [156, 4000000, 1],
    [157, 4000000, 1],
    [158, 4000000, 1],
    [159, 4000000, 1],
    [160, 4000000, 1],
    [161, 4000000, 1],
    [162, 4000000, 1],
    [163, 4000000, 1],
    [164, 4000000, 1],
    [165, 4000000, 1],
    [166, 4000000, 1],
    [167, 4000000, 1],
    [168, 4000000, 1],
    [169, 4000000, 1],
    [170, 4000000, 1],
    [171, 4000000, 1],
    [172, 4000000, 1],
    [173, 4000000, 1],
    [174, 4000000, 1],
    [175, 4000000, 1],
    [176, 4000000, 1],
    [177, 4000000, 1],
    [178, 4000000, 1],
    [179, 4000000, 1],
    [180, 4000000, 1],
    [181, 4000000, 1],
    [182, 4000000, 1],
    [183, 4000000, 1],
    [184, 4000000, 1],
    [185, 4000000, 1],
    [186, 4000000, 1],
    [187, 4000000, 1],
    [188, 4000000, 1],
    [189, 4000000, 1],
    [190, 4000000, 1],
    [191, 4000000, 1],
    [192, 4000000, 1],
    [193, 4000000, 1],
    [194, 4000000, 1],
    [195, 4000000, 1],
    [196, 4000000, 1],
    [197, 4000000, 1],
    [198, 4000000, 1],
    [199, 4000000, 1],
    [200, 4000000, 1],
    [201, 4000000, 1],
    [202, 4000000, 1],
    [203, 4000000, 1],
    [204, 4000000, 1],
    [205, 4000000, 1],
    [206, 4000000, 1],
    [207, 4000000, 1],
    [208, 4000000, 1],
    [209, 4000000, 1],
    [210, 4000000, 1],
    [211, 4000000, 1],
    [212, 4000000, 1],
    [213, 4000000, 1],
    [214, 4000000, 1],
    [215, 4000000, 1],
    [216, 4000000, 1],
    [217, 4000000, 1],
    [218, 4000000, 1],
    [219, 4000000, 1],
    [220, 4000000, 1],
    [221, 4000000, 1],
    [222, 4000000, 1],
    [223, 4000000, 1],
    [224, 4000000, 1],
    [225, 4000000, 1],
    [226, 4000000, 1],
    [227, 4000000, 1],
    [228, 4000000, 1],
    [229, 4000000, 1],
    [230, 4000000, 1],
    [231, 4000000, 1],
    [232, 4000000, 1],
    [233, 4000000, 1],
    [234, 4000000, 1],
    [235, 4000000, 1],
    [236, 4000000, 1],
    [237, 4000000, 1],
    [238, 4000000, 1],
    [239, 4000000, 1],
    [240, 4000000, 1],
    [241, 4000000, 1],
    [242, 4000000, 1],
    [243, 4000000, 1],
    [244, 4000000, 1],
    [245, 4000000, 1],
    [246, 4000000, 1],
    [247, 4000000, 1],
    [248, 4000000, 1],
    [249, 4000000, 1],
    [250, 4000000, 1],
    [251, 4000000, 1],
    [252, 4000000, 1],
    [253, 4000000, 1],
    [254, 4000000, 1],
    [255, 4000000, 1],
    [256, 4000000, 1],
    [257, 4000000, 1],
    [258, 4000000, 1],
    [259, 4000000, 1],
    [260, 4000000, 1],
    [261, 4000000, 1],
    [262, 4000000, 1],
    [263, 4000000, 1],
    [264, 4000000, 1],
    [265, 4000000, 1],
    [266, 4000000, 1],
    [267, 4000000, 1],
    [268, 4000000, 1],
    [269, 4000000, 1],
    [270, 4000000, 1],
    [271, 4000000, 1],
    [272, 4000000, 1],
    [273, 4000000, 1],
    [274, 4000000, 1],
    [275, 4000000, 1],
    [276, 4000000, 1],
    [277, 4000000, 1],
    [278, 4000000, 1],
    [279, 4000000, 1],
    [280, 4000000, 1],
    [281, 4000000, 1],
    [282, 4000000, 1],
    [283, 4000000, 1],
    [284, 4000000, 1],
    [285, 4000000, 1],
    [286, 4000000, 1],
    [287, 4000000, 1],
    [288, 4000000, 1],
    [289, 4000000, 1],
    [290, 4000000, 1],
    [291, 4000000, 1],
    [292, 4000000, 1],
    [293, 4000000, 1],
    [294, 4000000, 1],
    [295, 4000000, 1],
    [296, 4000000, 1],
    [297, 4000000, 1],
    [298, 4000000, 1],
    [299, 4000000, 1],
    [300, 4000000, 1],
    [301, 4000000, 1],
    [302, 4000000, 1],
    [303, 4000000, 1],
    [304, 4000000, 1],
    [305, 4000000, 1],
    [306, 4000000, 1],
    [307, 4000000, 1],
    [308, 4000000, 1],
    [309, 4000000, 1],
    [310, 4000000, 1],
    [311, 4000000, 1],
    [312, 4000000, 1],
    [313, 4000000, 1],
    [314, 4000000, 1],
    [315, 4000000, 1],
    [316, 4000000, 1],
    [317, 4000000, 1],
    [318, 4000000, 1],
    [319, 4000000, 1],
    [320, 4000000, 1],
    [321, 4000000, 1],
    [322, 4000000, 1],
    [323, 4000000, 1],
    [324, 4000000, 1],
    [325, 4000000, 1],
    [326, 4000000, 1],
    [327, 4000000, 1],
    [328, 4000000, 1],
    [329, 4000000, 1],
    [330, 4000000, 1],
    [331, 4000000, 1],
    [332, 4000000, 1],
    [333, 4000000, 1],
    [334, 4000000, 1],
    [335, 4000000, 1],
    [336, 4000000, 1],
    [337, 4000000, 1],
    [338, 4000000, 1],
    [339, 4000000, 1],
    [340, 4000000, 1],
    [341, 4000000, 1],
    [342, 4000000, 1],
    [343, 4000000, 1],
    [344, 4000000, 1],
    [345, 4000000, 1],
    [346, 4000000, 1],
    [347, 4000000, 1],
    [348, 4000000, 1],
    [349, 4000000, 1],
    [350, 4000000, 1],
    [351, 4000000, 1],
    [352, 4000000, 1],
    [353, 4000000, 1],
    [354, 4000000, 1],
    [355, 4000000, 1],
    [356, 4000000, 1],
    [357, 4000000, 1],
    [358, 4000000, 1],
    [359, 4000000, 1],
    [360, 4000000, 1],
    [361, 4000000, 1],
    [362, 4000000, 1],
    [363, 4000000, 1],
    [364, 4000000, 1],
    [365, 4000000, 1],
    [366, 4000000, 1],
    [367, 4000000, 1],
    [368, 4000000, 1],
    [369, 4000000, 1],
    [370, 4000000, 1],
    [371, 4000000, 1],
    [372, 4000000, 1],
    [373, 4000000, 1],
    [374, 4000000, 1],
    [375, 4000000, 1],
    [376, 4000000, 1],
    [377, 4000000, 1],
    [378, 4000000, 1],
    [379, 4000000, 1],
    [380, 4000000, 1],
    [381, 4000000, 1],
    [382, 4000000, 1],
    [383, 4000000, 1],
    [384, 4000000, 1],
    [385, 4000000, 1],
    [386, 4000000, 1],
    [387, 4000000, 1],
    [388, 4000000, 1],
    [389, 4000000, 1],
    [390, 4000000, 1],
    [391, 4000000, 1],
    [392, 4000000, 1],
    [393, 4000000, 1],
    [394, 4000000, 1],
    [395, 4000000, 1],
    [396, 4000000, 1],
    [397, 4000000, 1],
    [398, 4000000, 1],
    [399, 4000000, 1],
    [400, 4000000, 1],
    [401, 4000000, 1],
    [402, 4000000, 1],
    [403, 4000000, 1],
    [404, 4000000, 1],
    [405, 4000000, 1],
    [406, 4000000, 1],
    [407, 4000000, 1],
    [408, 4000000, 1],
    [409, 4000000, 1],
    [410, 4000000, 1],
    [411, 4000000, 1],
    [412, 4000000, 1],
    [413, 4000000, 1],
    [414, 4000000, 1],
    [415, 4000000, 1],
    [416, 4000000, 1],
    [417, 4000000, 1],
    [418, 4000000, 1],
    [419, 4000000, 1],
    [420, 4000000, 1],
    [421, 4000000, 1],
    [422, 4000000, 1],
    [423, 4000000, 1],
    [424, 4000000, 1],
    [425, 4000000, 1],
    [426, 4000000, 1],
    [427, 4000000, 1],
    [428, 4000000, 1],
    [429, 4000000, 1],
    [430, 4000000, 1],
    [431, 4000000, 1],
    [432, 4000000, 1],
    [433, 4000000, 1],
    [434, 4000000, 1],
    [435, 4000000, 1],
    [436, 4000000, 1],
    [437, 4000000, 1],
    [438, 4000000, 1],
    [439, 4000000, 1],
    [440, 4000000, 1],
    [441, 4000000, 1],
    [442, 4000000, 1],
    [443, 4000000, 1],
    [444, 4000000, 1],
    [445, 4000000, 1],
    [446, 4000000, 1],
    [447, 4000000, 1],
    [448, 4000000, 1],
    [449, 4000000, 1],
    [450, 4000000, 1],
    [451, 4000000, 1],
    [452, 4000000, 1],
    [453, 4000000, 1],
    [454, 4000000, 1],
    [455, 4000000, 1],
    [456, 4000000, 1],
    [457, 4000000, 1],
    [458, 4000000, 1],
    [459, 4000000, 1],
    [460, 4000000, 1],
    [461, 4000000, 1],
    [462, 4000000, 1],
    [463, 4000000, 1],
    [464, 4000000, 1],
    [465, 4000000, 1],
    [466, 4000000, 1],
    [467, 4000000, 1],
    [468, 4000000, 1],
    [469, 4000000, 1],
    [470, 4000000, 1],
    [471, 4000000, 1],
    [472, 4000000, 1],
    [473, 4000000, 1],
    [474, 4000000, 1],
    [475, 4000000, 1],
    [476, 4000000, 1],
    [477, 4000000, 1],
    [478, 4000000, 1],
    [479, 4000000, 1],
    [480, 4000000, 1],
    [481, 4000000, 1],
    [482, 4000000, 1],
    [483, 4000000, 1],
    [484, 4000000, 1],
    [485, 4000000, 1],
    [486, 4000000, 1],
    [487, 4000000, 1],
    [488, 4000000, 1],
    [489, 4000000, 1],
    [490, 4000000, 1],
    [491, 4000000, 1],
    [492, 4000000, 1],
    [493, 4000000, 1],
    [494, 4000000, 1],
    [495, 4000000, 1],
    [496, 4000000, 1],
    [497, 4000000, 1],
    [498, 4000000, 1],
    [499, 4000000, 1],
    [500, 4000000, 1],
    [501, 4000000, 1],
    [502, 4000000, 1],
    [503, 4000000, 1],
    [504, 4000000, 1],
    [505, 4000000, 1],
    [506, 4000000, 1],
    [507, 4000000, 1],
    [508, 4000000, 1],
    [509, 4000000, 1],
    [510, 4000000, 1],
    [511, 4000000, 1],
    [512, 4000000, 1],
    [513, 4000000, 1],
    [514, 4000000, 1],
    [515, 4000000, 1],
    [516, 4000000, 1],
    [517, 4000000, 1],
    [518, 4000000, 1],
    [519, 4000000, 1],
    [520, 4000000, 1],
    [521, 4000000, 1],
    [522, 4000000, 1],
    [523, 4000000, 1],
    [524, 4000000, 1],
    [525, 4000000, 1],
    [526, 4000000, 1],
    [527, 4000000, 1],
    [528, 4000000, 1],
    [529, 4000000, 1],
    [530, 4000000, 1],
    [531, 4000000, 1],
    [532, 4000000, 1],
    [533, 4000000, 1],
    [534, 4000000, 1],
    [535, 4000000, 1],
    [536, 4000000, 1],
    [537, 4000000, 1],
    [538, 4000000, 1],
    [539, 4000000, 1],
    [540, 4000000, 1],
    [541, 4000000, 1],
    [542, 4000000, 1],
    [543, 4000000, 1],
    [544, 4000000, 1],
    [545, 4000000, 1],
    [546, 4000000, 1],
    [547, 4000000, 1],
    [548, 4000000, 1],
    [549, 4000000, 1],
    [550, 4000000, 1],
    [551, 4000000, 1],
    [552, 4000000, 1],
    [553, 4000000, 1],
    [554, 4000000, 1],
    [555, 4000000, 1],
    [556, 4000000, 1],
    [557, 4000000, 1],
    [558, 4000000, 1],
    [559, 4000000, 1],
    [560, 4000000, 1],
    [561, 4000000, 1],
    [562, 4000000, 1],
    [563, 4000000, 1],
    [564, 4000000, 1],
    [565, 4000000, 1],
    [566, 4000000, 1],
    [567, 4000000, 1],
    [568, 4000000, 1],
    [569, 4000000, 1],
    [570, 4000000, 1],
    [571, 4000000, 1],
    [572, 4000000, 1],
    [573, 4000000, 1],
    [574, 4000000, 1],
    [575, 4000000, 1],
    [576, 4000000, 1],
    [577, 4000000, 1],
    [578, 4000000, 1],
    [579, 4000000, 1],
    [580, 4000000, 1],
    [581, 4000000, 1],
    [582, 4000000, 1],
    [583, 4000000, 1],
    [584, 4000000, 1],
    [585, 4000000, 1],
    [586, 4000000, 1],
    [587, 4000000, 1],
    [588, 4000000, 1],
    [589, 4000000, 1],
    [590, 4000000, 1],
    [591, 4000000, 1],
    [592, 4000000, 1],
    [593, 4000000, 1],
    [594, 4000000, 1],
    [595, 4000000, 1],
    [596, 4000000, 1],
    [597, 4000000, 1],
    [598, 4000000, 1],
    [599, 4000000, 1],
    [600, 4000000, 1],
    [601, 4000000, 1],
    [602, 4000000, 1],
    [603, 4000000, 1],
    [604, 4000000, 1],
    [605, 4000000, 1],
    [606, 4000000, 1],
    [607, 4000000, 1],
    [608, 4000000, 1],
    [609, 4000000, 1],
    [610, 4000000, 1],
    [611, 4000000, 1],
    [612, 4000000, 1],
    [613, 4000000, 1],
    [614, 4000000, 1],
    [615, 4000000, 1],
    [616, 4000000, 1],
    [617, 4000000, 1],
    [618, 4000000, 1],
    [619, 4000000, 1],
    [620, 4000000, 1],
    [621, 4000000, 1],
    [622, 4000000, 1],
    [623, 4000000, 1],
    [624, 4000000, 1],
    [625, 4000000, 1],
    [626, 4000000, 1],
    [627, 4000000, 1],
    [628, 4000000, 1],
    [629, 4000000, 1],
    [630, 4000000, 1],
    [631, 4000000, 1],
    [632, 4000000, 1],
    [633, 4000000, 1],
    [634, 4000000, 1],
    [635, 4000000, 1],
    [636, 4000000, 1],
    [637, 4000000, 1],
    [638, 4000000, 1],
    [639, 4000000, 1],
    [640, 4000000, 1],
    [641, 4000000, 1],
    [642, 4000000, 1],
    [643, 4000000, 1],
    [644, 4000000, 1],
    [645, 4000000, 1],
    [646, 4000000, 1],
    [647, 4000000, 1],
    [648, 4000000, 1],
    [649, 4000000, 1],
    [650, 4000000, 1],
    [651, 4000000, 1],
    [652, 4000000, 1],
    [653, 4000000, 1],
    [654, 4000000, 1],
    [655, 4000000, 1],
    [656, 4000000, 1],
    [657, 4000000, 1],
    [658, 4000000, 1],
    [659, 4000000, 1],
    [660, 4000000, 1],
    [661, 4000000, 1],
    [662, 4000000, 1],
    [663, 4000000, 1],
    [664, 4000000, 1],
    [665, 4000000, 1],
    [666, 4000000, 1],
    [667, 4000000, 1],
    [668, 4000000, 1],
    [669, 4000000, 1],
    [670, 4000000, 1],
    [671, 4000000, 1],
    [672, 4000000, 1],
    [673, 4000000, 1],
    [674, 4000000, 1],
    [675, 4000000, 1],
    [676, 4000000, 1],
    [677, 4000000, 1],
    [678, 4000000, 1],
    [679, 4000000, 1],
    [680, 4000000, 1],
    [681, 4000000, 1],
    [682, 4000000, 1],
    [683, 4000000, 1],
    [684, 4000000, 1],
    [685, 4000000, 1],
    [686, 4000000, 1],
    [687, 4000000, 1],
    [688, 4000000, 1],
    [689, 4000000, 1],
    [690, 4000000, 1] // TMS250, After Resort
];

function start() {
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode === 1) {
        status++;
    } else if (mode === 0) {
        status--;
    } else {
        cm.dispose();
        return;
    }
    if (status <= -1) {
        cm.dispose();
    } else if (status === 0) {
        if (cm.getPlayer().getCustomDamageSkin() === -1) { // 尚未切換過傷害字型
            cm.getPlayer().setCustomDamageSkin(0);
        }
        let msg = "歡迎使用傷害字型兌換功能\r\n";
        msg += "#L0#我要#b兌換#d傷害字型#k#l\r\n";
        msg += "#L1#我要#r查看#d傷害字型#k倉庫#l\r\n";
        if (cm.getPlayer().getCustomDamageSkin() !== 0) {
            msg += "#L2#我要#r重置#k使用中的#d傷害字型#l\r\n";
        }
        if (cm.getPlayer().getGMLevel() > 0) {
            msg += "#L100##d切換傷害字型 [管理專用]#k#l\r\n";
        }
        msg += "#L3##r離開\r\n";
        cm.sendSimple(msg);
    } else if (status === 1) {
        if (mode === 1) {
            sel = selection;
        }
        if (sel === 0) {
            let msg = "請選擇要兌換的傷害字型";
            if (money > 0) {
                msg += "(需要#r" + cm.numberWithCommas(money) + "#k元)";
            }
            msg += "\r\n\r\n";
            for (var i = 0; i < exchangeInfo.length; i++) {
                msg += "#L" + i + "#" + getPicture(exchangeInfo[i][0]) + "";
                if (showDamageForDamageSkin) {
                    let damageRate = cm.getCustomDamageSkinDamageRate(exchangeInfo[i][0]);
                    if (damageRate > 0) {
                        msg += " - #d傷害增加: #r" + cm.getCustomDamageSkinDamageRate(exchangeInfo[i][0]) + "#d%#k#l\r\n";
                    } else {
                        msg += " - #b未增加傷害#k#l\r\n";
                    }
                }
            }
            cm.sendSimple(msg);
        } else if (sel === 1) {
            if (getDamageSkinIdFromBank().isEmpty()) {
                cm.sendNext("倉庫裡目前是空的");
                sel = -1;
                status = -1;
                return;
            }
            var currentSkin = cm.getPlayer().getCustomDamageSkin();
            var currentSkinDamageRate = cm.getCustomDamageSkinDamageRate(currentSkin);
            let msg = "使用中傷害字型: " + getPicture(currentSkin);
            if (showDamageForDamageSkin) {
                if (currentSkinDamageRate > 0) {
                    msg += " - #d傷害增加: #r" + currentSkinDamageRate + "#d%#k#l\r\n";
                } else {
                    msg += " - #b未增加傷害#k#l\r\n";
                }
            }
            msg += "\r\n";
            msg += "請選擇要使用的傷害字型\r\n";
            let iter = getDamageSkinIdFromBank().iterator();
            while (iter.hasNext()) {
                var skinId = iter.next();
                if (skinId !== 0 && skinId !== currentSkin) {
                    msg += "#L" + skinId + "#" + getPicture(skinId) + "";
                    if (showDamageForDamageSkin) {
                        let damageRate = cm.getCustomDamageSkinDamageRate(skinId);
                        if (damageRate > 0) {
                            msg += " - #d傷害增加: #r" + cm.getCustomDamageSkinDamageRate(skinId) + "#d%#k#l\r\n";
                        } else {
                            msg += " - #b未增加傷害#k#l\r\n";
                        }
                    }
                }
            }
            cm.sendSimple(msg);
        } else if (sel === 2) {
            cm.getPlayer().changeCustomDamageSkin(0);
            cm.sendNext("重置傷害字型完成");
            sel = -1;
            status = -1;
        } else if (sel === 100 && cm.getPlayer().isGM()) {
            let msg = "請選擇要兌換的傷害字型:\r\n\r\n";
            for (let i = 0; i < exchangeInfo.length; i++) {
                msg += "#L" + i + "#" + i + "" + getPicture(exchangeInfo[i][0]);
                if (showDamageForDamageSkin) {
                    let damageRate = cm.getCustomDamageSkinDamageRate(exchangeInfo[i][0]);
                    if (damageRate > 0) {
                        msg += " - #d傷害增加: #r" + cm.getCustomDamageSkinDamageRate(exchangeInfo[i][0]) + "#d%#k#l\r\n";
                    } else {
                        msg += " - #b未增加傷害#k#l\r\n";
                    }
                }
            }
            cm.sendSimple(msg);
        } else {
            cm.dispose();
        }
    } else if (status === 2) {
        if (sel === 0) {
            if (selection < 0) {
                cm.sendNext("發生未知的錯誤");
                cm.dispose();
                return;
            }
            let skinId = exchangeInfo[selection][0];
            if (exchangeInfo[selection][1] > 0 && exchangeInfo[selection][2] > 0 && !cm.haveItem(exchangeInfo[selection][1], exchangeInfo[selection][2])) {
                cm.sendNext("身上必須要有#v" + exchangeInfo[selection][1] + "#" + exchangeInfo[selection][2] + "個才能兌換");
                sel = -1;
                status = -1;
                return;
            } else if (hasDamageSkinInBank(skinId)) {
                cm.getPlayer().changeCustomDamageSkin(skinId);
                cm.sendNext("倉庫裡已經有" + getPicture(skinId) + "了，並且自動套用為目前使用的傷害字型");
                sel = -1;
                status = -1;
                return;
            } else if (cm.getPlayer().getMeso() < money) {
                cm.sendOk("楓幣不足");
                cm.dispose();
                return;
            }
            if (money > 0) {
                cm.gainMeso(-money);
            }
            if (exchangeInfo[selection][1] > 0 && exchangeInfo[selection][2] > 0 && cm.haveItem(exchangeInfo[selection][1], exchangeInfo[selection][2])) {
                if (consumeItem) {
                    cm.gainItem(exchangeInfo[selection][1], -exchangeInfo[selection][2]);
                }
            }
            addDamageSkinToBank(skinId);
            cm.sendNext("已經獲得傷害字型:" + getPicture(skinId) + "請去倉庫內查看");
            sel = -1;
            status = -1;
        } else if (sel === 1) {
            if (!hasDamageSkinInBank(selection)) {
                cm.sendNext("沒有選擇字型 ");
                sel = -1;
                status = -1;
                return;
            }
            cm.getPlayer().changeCustomDamageSkin(parseInt(selection));
            cm.sendNext("套用傷害字型" + getPicture(selection) + "成功");
            sel = -1;
            status = -1;
        } else if (sel === 100) {
            addDamageSkinToBank(selection);
            cm.getPlayer().changeCustomDamageSkin(selection);
            cm.getPlayer().yellowMessage("傷害字型編號: " + selection);
            cm.sendNext("更換成功！");
            cm.dispose();
        }
    }
}

function addDamageSkinToBank(skinId) {
    if (account) {
        cm.getPlayer().addCustomAccountDamageSkinBank(skinId);
    } else {
        cm.getPlayer().addCustomDamageSkinBank(skinId);
    }
}

function hasDamageSkinInBank(skinId) {
    if (account) {
        return cm.getPlayer().hasCustomAccountDamageSkinInBank(skinId);
    } else {
        return cm.getPlayer().hasCustomDamageSkinInBank(skinId);
    }
}

function getDamageSkinIdFromBank() {
    return account ? cm.getPlayer().getCustomAccountDamageSkinBank() : cm.getPlayer().getCustomDamageSkinBank();
}

function getPicture(skin) {
    if (cm.isCustomDamageSkinAnimation(skin)) {
        return link + skinId + "/0/0#"
    } else {
        return link + skinId + "/0#"
    }
}